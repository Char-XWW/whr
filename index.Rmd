---
title: "World Happiness Report in 2017"
output: html_document
editor_options:
  chunk_output_type: console
---
```{r setup,include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```


## 0.0_Introduction


Happinnes is a very subjective term. Trying to quantify and standardize it is a fools task. The World Happiness Score as provided by citizens of different contries as part of a servey is a standardized although still subjective measure. This won't stop us from trying to analyze it though! 

 Now with the help of some graphics I will attempt to explore the  World Happiness Score in 2017 and the possible factors influencing it. 

### 0.1_Prepare Data

```{r}
install.packages("plotly")
install.packages("corrplot")
data <- readr::read_csv(file = "data/2017.csv")
```

## 1.0_ Graphic
### 1.1_Correlation map

```{r}
library("corrplot")
library("dplyr")
corrplot(cor(data %>%
  select(Happiness.Score:Dystopia.Residual)),
method = "color",
sig.level = 0.01, insig = "blank",
addCoef.col = "black",
tl.srt = 45,
type = "upper",
tl.col = "gray",
tl.cex = 0.7,
number.cex = 0.7
)
```
This correlation plots shows us that Economic GDP score tends to have the biggest impact to happiness score and the Health score has the second biggest impact.Correlation between EGP and Happiness Score, Whisker high, whisker low are all 0,81, and it reachs even 0,84 when we put EGP and health Life Expectancy together.  
  

### 1.2_Ranking: Countries and their Scores

```{r}
library(plotly)
p <- ggplot(data = data, aes(x = Happiness.Score, y = reorder(Country, Happiness.Score))) + geom_point(colour = "red", alpha = .5) +
  geom_segment(aes(yend = reorder(Country, Happiness.Score)), xend = 0, colour = "pink", alpha = .5) + theme(axis.text.y = element_text(angle = 0, hjust = 1)) +
  labs(title = "World Happiness Rank in 2017", y = "Country", x = "Happiness.Score")
ggplotly(p)
```
Seems most of european countries have higher scores and afican countries have the lower scores. Follow we will use a Worldmap funktion to verify this guess.  
  
### 1.3_World Map: Happiness Scores on a map

```{r}
library("wildcard")
world <- map_data("world")
world <- world %>% filter(region != "Antarctica")
world <- fortify(world)
data <- data
data <- wildcard(
  df = data, wildcard = "United States", values = "USA",
  expand = TRUE, rules = NULL
)
data <- wildcard(
  df = data, wildcard = "United Kingdom", values = "UK",
  expand = TRUE, rules = NULL
)
data <- wildcard(
  df = data, wildcard = "Democratic Republic of the Congo", values = "Congo (Kinshasa)",
  expand = TRUE, rules = NULL
)
ggplot() +
  geom_map(
    data = world, map = world,
    aes(x = long, y = lat, group = group, map_id = region),
    fill = "white", colour = "black"
  ) +
  geom_map(
    data = data, map = world,
    aes(fill = Happiness.Score, map_id = Country),
    colour = "black"
  ) +
  scale_fill_continuous(
    low = "red", high = "yellow",
    guide = "colorbar"
  ) +
  labs(title = "World Happiness Score in 2017")
```
Worldmap shows us that America has actually the highest score while most of european contries have good scores.
Asien countries follows Europe. Compare to the rest of the world a lot of african countries stay less happy or even unhappy.  
  
## 1.4_Scatter Plot: Correlation between GDP, Happiness and Health Expectancy.

```{r}
library("viridis")
w <- ggplot(data = data, aes(Economy..GDP.per.Capita., Happiness.Score, color = Health..Life.Expectancy.), main = "Correlation of GDP, Happiness and Health Expectancy in 2017") + geom_point()
w <- w + ggtitle("Correlation of GDP, Happiness and Health Expectancy in 2017")
w <- w + labs(x = "GDP Per Capita", y = "Happiness Score", colour = "Health Expectancy")
w <- w + geom_smooth()
w <- w + scale_color_viridis(option = "D")
w
```
This interactive scatterplot shows that there is a strong positive correlation between GDP and Happiness. Also points are coloured by the Health score, which also suggeests that Health tends to have big impact to happiness.  
  
### Summary

In general there seems to be a positive correlation between the Health Life Expectancy of a country, it's economic output (GDP) and the happiness of the population, which is quite obvious.
Some interesting points while exploring the correlations between the different factors in the data set are:
- GDP per Capita / Family and Health Life Expectancy seem to be most influencial to the happiness of a country's citizens.
- Curiously GDP per Capita and Generosity have a slightly negative correlation - this might be an outlier or an error in my methodology, but analyzing this goes beyond my R capabilities.

Furthermore looking at the map it is noticable that the majority of South American Contries tend to have proportinally higher Happiness Scores when compared to their economic prowess per capita. This might be culturally influenced. 

