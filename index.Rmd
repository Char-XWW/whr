---
title: "World Happiness Report in 2017"
output: html_document
---


## 0.0_Introduction


In this fast-move society, people are alway capble of multitask. It seems everyone gets what they have seeked for long time. But still, no matter what we already have had or achieved, are we really happy? I mean, really happy? The criterien of being happy is also diffenert.

In fact, the “pursuit of happiness” was a vital part of the United States Declaration of Independence, written in 1776. With Thomas Jefferson stating how he believed that happiness is attainable by gaining knowledge and living a self-sufficient life surrounded by friends. 

If we look at the multitude of global religions, we see a similar importance placed on the idea of happiness. Now with some graphics I will show you the World Happiness Score in 2017 in different point of views 


```{r}
data <- readr::read_csv(file = "data/2017.csv")
```
## 1.0_ Graphic

```{r}

```

## 1.1_Scatter Plot: Happiness Score and GDP per Capital

```{r}
library (ggplot2)
g <- ggplot(data = data, 
                        mapping = aes(x = Economy..GDP.per.Capita. , y = Happiness.Score,                                       color = Health..Life.Expectancy.)
)
g <- g + geom_smooth()
g <- g + geom_point()
g
```

## 1.2_Ranking: Contries and their Scores

```{r}
library(plotly)
p <- ggplot(data = data, aes(x = Happiness.Score, y = reorder(Country, Happiness.Score))) + geom_point(colour = "red", alpha = .5) + 
geom_segment(aes(yend=reorder(Country, Happiness.Score)), xend = 0, colour="pink", alpha = .5) + theme(axis.text.y = element_text(angle = 0, hjust = 1)
) + 
labs(title = "World Happiness Rank in 2017", y = "Country", x = "Happiness.Score")
usethis::use_package("plotly")
ggplotly(p)
```

## 1.3_World Map: happiness Score in the Worldmap

```{r}
install.packages("maps", repos = "http://cran.us.r-project.org")
install.packages("wildcard", repos = "http://cran.us.r-project.org")
library("wildcard" )
world <- map_data('world')
world <- world %>% filter(region != "Antarctica")
world <- fortify(world)
data <- data
data <- wildcard(df = data, wildcard = "United States", values = "USA",
         expand = TRUE, rules = NULL)
data <- wildcard(df = data, wildcard = "United Kingdom", values = "UK",
         expand = TRUE, rules = NULL)

data <- wildcard(df = data, wildcard = "Democratic Republic of the Congo", values = "Congo (Kinshasa)",
         expand = TRUE, rules = NULL)
ggplot() + 
  geom_map(data=world, map=world,
                  aes(x=long, y=lat, group=group, map_id=region),
                  fill="white", colour="black") + 
  geom_map(data=data, map=world,
                  aes(fill=Happiness.Score, map_id=Country),
                  colour="black") + 
  scale_fill_continuous(low="red", high="yellow",
                               guide="colorbar") + 
  labs(title = "World Happiness Score in 2017")
```

## 1.4_Scatter Plot: Correlation between GDP, Happiness and Health..Life.Expectancy.

```{r}
install.packages("viridisLite")
library("viridisLite")
w <- ggplot(data = data, aes( Economy..GDP.per.Capita., Happiness.Score,color = Health..Life.Expectancy.), main = "Correlation of GDP, Happiness and Health Expectancy in 2017") + geom_point()
w <- w + ggtitle("Correlation of GDP, Happiness and Health Expectancy in 2017")
w <- w + labs(x = "GDP Per Capita", y = "Happiness Score", colour = "Health Expectancy" )
w <- w + geom_smooth()
w <- w + scale_color_viridis(option = "D")
w
```
